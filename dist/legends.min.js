/*!
 * Legends.js
 * MIT License
 * https://github.com/nodejitsu/http-server.git 
 */
!function(){function a(b,c){return b=Array.prototype.slice.call(b,0),null==c&&(c=[]),b.forEach(function(b){Array.isArray(b)?a(b,c):c.push(b)}),c}function b(a){return"string"==typeof a?a:"boolean"==typeof a?a?"true":"false":""}function c(a,c,d){return null==a&&(a=void 0),null==c&&(c="&"),null==d&&(d="="),"object"==typeof a?Object.keys(a).map(function(e){var f=encodeURIComponent(b(e))+d,g=a[e];return Array.isArray(g)?g.map(function(a){return f+encodeURIComponent(b(a))}).join(c):f+encodeURIComponent(b(g))}).join(c):""}function d(a,b){if(null==a&&(a=new Error),a.name="HTTPError",null!=b){var c=b.status||b.statusCode;if(!a.message){var d=j[c];null==d&&(d="Server responded with status code "+c),a.message=d}a.status=c,a.response=b,a.toString=function(){return this.name+" "+this.status+": "+this.message}}return a}function e(a){var b=require("http"),c=i();return b.get(a,function(a){function b(b){c.reject(d(b,a))}if(a.on("error",b),a.statusCode>=400)return b();var e="";a.on("data",function(a){e+=a.toString("utf-8")}),a.on("end",function(){try{c.resolve(JSON.parse(e))}catch(a){b(a)}})}).on("error",function(a){c.reject(d(a))}),c.promise}function f(a){function b(a){e.reject(d(a,c))}var c=new XMLHttpRequest,e=i();return c.onload=function(){if(c.status>=400)return b();try{e.resolve(JSON.parse(c.responseText))}catch(a){b(a)}},c.open("get",a),c.send(),e.promise}function g(){return"function"==typeof require?e.apply(null,arguments):f.apply(null,arguments)}function h(a,b){return this instanceof h?(this.key=a,this.region=b,void 0):new h(a,b)}var i=function(a){"use strict";function b(a){j(function(){throw a})}function c(b){return this.then(b,a)}function d(b){return this.then(a,b)}function e(b,c){return this.then(function(a){return k(b)?b.apply(null,l(a)?a:[a]):t.onlyFuncs?a:b},c||a)}function f(a){function b(){a()}return this.then(b,b),this}function g(a){return this.then(function(b){return k(a)?a.apply(null,[void 0,b]):t.onlyFuncs?b:a},function(b){return a(b)})}function h(c){return this.then(a,c?function(a){throw c(a),a}:b)}function i(a,b){var c=o(a);if(1===c.length&&l(c[0])){if(!c[0].length)return t.fulfilled([]);c=c[0]}var d=[],e=t(),f=c.length;if(f)for(var g=(function(a){c[a]=t.promisify(c[a]),c[a].then(function(g){a in d||(d[a]=b?c[a]:g,--f||e.resolve(d))},function(g){a in d||(b?(d[a]=c[a],--f||e.resolve(d)):e.reject(g))})}),h=0,i=f;i>h;h++)g(h);else e.resolve(d);return e.promise}var j,k=function(a){return"function"==typeof a},l=function(a){return Array.isArray?Array.isArray(a):a instanceof Array},m=function(a){return!(!a||!(typeof a).match(/function|object/))},n=function(b){return b===!1||b===a||null===b},o=function(a,b){return[].slice.call(a,b)},p="undefined",q=typeof TypeError===p?Error:TypeError;if(typeof process!==p&&process.nextTick)j=process.nextTick;else if(typeof MessageChannel!==p){var r=new MessageChannel,s=[];r.port1.onmessage=function(){s.length&&s.shift()()},j=function(a){s.push(a),r.port2.postMessage(0)}}else j=function(a){setTimeout(a,0)};var t=function(b){function i(){if(0!==s){var a,b=u,c=0,d=b.length,e=~s?0:1;for(u=[];d>c;c++)(a=b[c][e])&&a(p)}}function l(a){function b(a){return function(b){return c?void 0:(c=!0,a(b))}}var c=!1;if(s)return this;try{var d=m(a)&&a.then;if(k(d)){if(a===v)throw new q("Promise can't resolve itself");return d.call(a,b(l),b(o)),this}}catch(e){return b(o)(e),this}return r(function(){p=a,s=1,i()}),this}function o(a){return s||r(function(){try{throw a}catch(b){p=b}s=-1,i()}),this}var p,r=(a!==b?b:t.alwaysAsync)?j:function(a){a()},s=0,u=[],v={then:function(a,b){var c=t();return u.push([function(b){try{n(a)?c.resolve(b):c.resolve(k(a)?a(b):t.onlyFuncs?b:a)}catch(d){c.reject(d)}},function(a){if((n(b)||!k(b)&&t.onlyFuncs)&&c.reject(a),b)try{c.resolve(k(b)?b(a):b)}catch(d){c.reject(d)}}]),0!==s&&r(i),c.promise},success:c,error:d,otherwise:d,apply:e,spread:e,ensure:f,nodify:g,rethrow:h,isPending:function(){return!(0!==s)},getStatus:function(){return s}};return v.toSource=v.toString=v.valueOf=function(){return p===a?this:p},{promise:v,resolve:l,fulfill:l,reject:o}};return t.deferred=t.defer=t,t.nextTick=j,t.alwaysAsync=!0,t.onlyFuncs=!0,t.resolved=t.fulfilled=function(a){return t(!0).resolve(a).promise},t.rejected=function(a){return t(!0).reject(a).promise},t.wait=function(a){var b=t();return setTimeout(b.resolve,a||0),b.promise},t.delay=function(a,b){var c=t();return setTimeout(function(){try{c.resolve(a.apply(null))}catch(b){c.reject(b)}},b||0),c.promise},t.promisify=function(a){return a&&k(a.then)?a:t.resolved(a)},t.all=function(){return i(arguments,!1)},t.resolveAll=function(){return i(arguments,!0)},t.nodeCapsule=function(a,b){return b||(b=a,a=void 0),function(){var c=t(),d=o(arguments);d.push(function(a,b){a?c.reject(a):c.resolve(arguments.length>2?o(arguments,1):b)});try{b.apply(a,d)}catch(e){c.reject(e)}return c.promise}},t}(),j={400:"Bad request",401:"Unauthorized",404:"Not found",500:"Internal server error"};h.request=function(a,b){"object"!=typeof a&&(a={});var d=null!=a.method?a.method:"",e=null!=a.region?a.region:"na",f=null!=a.version?a.version:"1.1",h=a.key,i="object"==typeof a.params?a.params:{},j=a.extract,k="http://prod.api.pvp.net/api/lol/";k+=e.toLowerCase()+"/","v"!=f[0]&&(f="v"+f),k+=f+"/",k+=d.split("/").map(function(a){return encodeURIComponent(a)}).reduce(function(a,b){return""!=b&&a.push(b),a},[]).join("/"),null!=h&&(i.api_key=h),k+="?"+c(i);var l=g(k);return null!=j&&(l=l.then(function(a){return a[j]})),"function"==typeof b&&l.nodify(b),l},h.prototype.request=function(a,b){return"object"!=typeof a&&(a={}),null==a.key&&(a.key=this.key),null==a.region&&(a.region=this.region),h.request(a,b)},h.MATCH_MAKING_QUEUES={2:"Normal 5v5 Blind Pick",4:"Ranked Solo 5v5",7:"Coop vs AI 5v5",8:"Normal 3v3",14:"Normal 5v5 Draft Pick",16:"Dominion 5v5 Blind Pick",17:"Dominion 5v5 Draft Pick",25:"Dominion Coop vs AI",41:"Ranked Team 3v3",42:"Ranked Team 5v5",52:"Twisted Treeline Coop vs AI",65:"ARAM",67:"ARAM Coop vs AI",70:"One for All 5v5",72:"Snowdown Showdown 1v1",73:"Snowdown Showdown 2v2"},h.MAP_NAMES={1:{name:"Summoner's Rift",notes:"Summer Variant"},2:{name:"Summoner's Rift",notes:"Autumn Variant"},3:{name:"The Proving Grounds",notes:"Tutorial Map"},4:{name:"Twisted Treeline",notes:"Original Version"},8:{name:"The Crystal Scar",notes:"Dominion Map"},10:{name:"Twisted Treeline",notes:"Current Version"},12:{name:"Howling Abyss",notes:"ARAM Map"}},h.REGIONS=["NA","EUW","EUNE","BR","TR"],h.prototype.getChampions=function(a,b){return"function"==typeof a&&null==b&&(b=a,a=!1),this.request({method:"champion",version:"1.1",params:{freeToPlay:a?!0:!1},extract:"champions"},b)},h.prototype.getRecentGames=function(a,b){return this.request({method:"game/by-summoner/"+a+"/recent",version:"1.2",extract:"games"},b)},h.prototype.getLeagues=function(a,b){return this.request({method:"league/by-summoner/"+a,version:"2.2"},b)},h.prototype.getSummaryStats=function(a,b,c){return"function"==typeof b&&null==c&&(c=b,b=null),null!=b&&(b="SEASON"+b),this.request({method:"stats/by-summoner/"+a+"/summary",version:"1.2",params:{season:b},extract:"playerStatSummaries"},c)},h.prototype.getRankedStats=function(a,b,c){return"function"==typeof b&&null==c&&(c=b,b=null),null!=b&&(b="SEASON"+b),this.request({method:"stats/by-summoner/"+a+"/ranked",version:"1.2",params:{season:b},extract:"champions"},c)},h.prototype.getSummonerById=function(a,b){return this.request({method:"summoner/"+a,version:"1.2"},b)},h.prototype.getSummonerByName=function(a,b){return this.request({method:"summoner/by-name/"+a,version:"1.2"},b)},h.prototype.getRunes=function(a,b){return this.request({method:"summoner/"+a+"/runes",version:"1.2",extract:"pages"},b)},h.prototype.getMasteries=function(a,b){return this.request({method:"summoner/"+a+"/masteries",version:"1.2",extract:"pages"},b)},h.prototype.getNames=function(){var b,c=a(arguments);c.length>0&&"function"==typeof c[c.length-1]&&(b=c.pop());for(var d,e=40,f=[];c.length;)d=c.splice(0,e).join(","),f.push(this.request({method:"summoner/"+d+"/name",version:"1.2",extract:"summoners"}));var g=i.all(f).success(function(a){return a.reduce(function(a,b){return a.concat(b)},[])});return b&&g.nodify(b),g},h.prototype.getTeams=function(a,b){return this.request({method:"team/by-summoner/"+a,version:"2.2"},b)},"object"==typeof module&&null!=module.exports?module.exports=h:"undefined"!=typeof window&&(window.Legends=h)}();