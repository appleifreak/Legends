/*!
 * Legends.js
 * MIT License
 * https://github.com/appleifreak/Legends.git 
 */
!function(){function a(b,c){return b=Array.prototype.slice.call(b,0),null==c&&(c=[]),b.forEach(function(b){Array.isArray(b)?a(b,c):c.push(b)}),c}function b(a,b){return a.then(function(a){return b(null,a)},function(a){return b(a)})}function c(a){var b=[],c=a.length;return new k(function(d,e){return c?(a.forEach(function(a,f){a=avow.lift(a),a.then(function(a){f in b||(b[f]=a,--c||d(b))},e)}),void 0):d(b)})}function d(a){return"string"==typeof a?a:"boolean"==typeof a?a?"true":"false":""}function e(a,b,c){return null==a&&(a=void 0),null==b&&(b="&"),null==c&&(c="="),"object"==typeof a?Object.keys(a).map(function(e){var f=encodeURIComponent(d(e))+c,g=a[e];return Array.isArray(g)?g.map(function(a){return f+encodeURIComponent(d(a))}).join(b):f+encodeURIComponent(d(g))}).join(b):""}function f(a,b){if(null==a&&(a=new Error),a.name="HTTPError",null!=b){var c=b.status||b.statusCode;if(!a.message){var d=l[c];null==d&&(d="Server responded with status code "+c),a.message=d}a.status=c,a.response=b,a.toString=function(){return this.name+" "+this.status+": "+this.message}}return a}function g(a){var b=require("http");return new k(function(c,d){b.get(a,function(a){function b(b){d(f(b,a))}if(a.on("error",b),a.statusCode>=400)return b();var e="";a.on("data",function(a){e+=a.toString("utf-8")}),a.on("end",function(){try{c(JSON.parse(e))}catch(a){b(a)}})}).on("error",function(a){d(f(a))})})}function h(a){var b=new XMLHttpRequest;return new k(function(c,d){function e(a){d(f(a,b))}b.onload=function(){if(b.status>=400)return e();try{c(JSON.parse(b.responseText))}catch(a){e(a)}},b.open("get",a),b.send()})}function i(a){return"function"==typeof require?g(a):h(a)}function j(a,b){return this instanceof j?(this.key=a,this.region=b,void 0):new j(a,b)}var k=function(a,b){function c(a,b){return(typeof b)[0]==a}function d(g,h){return h=function i(j,k,l,m,n){function o(a){return function(b){n&&(n=0,i(c,a,b))}}if(m=i.q,j!=c)return d(function(a,b){m.push({p:this,r:a,j:b,1:j,0:k})});if(l&&c(a,l)|c(b,l))try{n=l.then}catch(p){k=0,l=p}if(c(a,n))try{n.call(l,o(1),k=o(0))}catch(p){k(p)}else for(h=e(g,l,k),g=0;g<m.length;)n=m[g++],c(a,j=n[k])?f(n.p,n.r,n.j,l,j):(k?n.r:n.j)(l)},h.q=[],g.call(g={then:function(a,b){return h(a,b)}},function(a){h(c,1,a)},function(a){h(c,0,a)}),g}function e(b,e,g){return function(h,i){return c(a,h=g?h:i)?d(function(a,b){f(this,a,b,e,h)}):b}}function f(d,e,f,g,h){setTimeout(function(){try{g=h(g),h=g&&c(b,g)|c(a,g)&&g.then,c(a,h)?g==d?f(new TypeError):h.call(g,e,f):e(g)}catch(i){f(i)}},0)}return d.resolve=function(a,b){return(b={}).then=e(b,a,1),b},d.reject=function(a,b){return(b={}).then=e(b,a,0),b},d}("f","o"),l={400:"Bad request",401:"Unauthorized",404:"Not found",500:"Internal server error"};j.request=function(a,c){"object"!=typeof a&&(a={});var d=null!=a.method?a.method:"",f=null!=a.region?a.region:"na",g=null!=a.version?a.version:"1.1",h=a.key,j="object"==typeof a.params?a.params:{},k=a.extract,l="http://prod.api.pvp.net/api/lol/";l+=f.toLowerCase()+"/","v"!=g[0]&&(g="v"+g),l+=g+"/",l+=d.split("/").map(function(a){return encodeURIComponent(a)}).reduce(function(a,b){return""!=b&&a.push(b),a},[]).join("/"),null!=h&&(j.api_key=h),l+="?"+e(j);var m=i(l);return null!=k&&(m=m.then(function(a){return a[k]})),"function"==typeof c&&b(m,c),m},j.prototype.request=function(a,b){return"object"!=typeof a&&(a={}),null==a.key&&(a.key=this.key),null==a.region&&(a.region=this.region),j.request(a,b)},j.MATCH_MAKING_QUEUES={2:"Normal 5v5 Blind Pick",4:"Ranked Solo 5v5",7:"Coop vs AI 5v5",8:"Normal 3v3",14:"Normal 5v5 Draft Pick",16:"Dominion 5v5 Blind Pick",17:"Dominion 5v5 Draft Pick",25:"Dominion Coop vs AI",41:"Ranked Team 3v3",42:"Ranked Team 5v5",52:"Twisted Treeline Coop vs AI",65:"ARAM",67:"ARAM Coop vs AI",70:"One for All 5v5",72:"Snowdown Showdown 1v1",73:"Snowdown Showdown 2v2"},j.MAP_NAMES={1:{name:"Summoner's Rift",notes:"Summer Variant"},2:{name:"Summoner's Rift",notes:"Autumn Variant"},3:{name:"The Proving Grounds",notes:"Tutorial Map"},4:{name:"Twisted Treeline",notes:"Original Version"},8:{name:"The Crystal Scar",notes:"Dominion Map"},10:{name:"Twisted Treeline",notes:"Current Version"},12:{name:"Howling Abyss",notes:"ARAM Map"}},j.REGIONS=["NA","EUW","EUNE","BR","TR"],j.prototype.getChampions=function(a,b){return"function"==typeof a&&null==b&&(b=a,a=!1),this.request({method:"champion",version:"1.1",params:{freeToPlay:a?!0:!1},extract:"champions"},b)},j.prototype.getRecentGames=function(a,b){return this.request({method:"game/by-summoner/"+a+"/recent",version:"1.2",extract:"games"},b)},j.prototype.getLeagues=function(a,b){return this.request({method:"league/by-summoner/"+a,version:"2.2"},b)},j.prototype.getSummaryStats=function(a,b,c){return"function"==typeof b&&null==c&&(c=b,b=null),null!=b&&(b="SEASON"+b),this.request({method:"stats/by-summoner/"+a+"/summary",version:"1.2",params:{season:b},extract:"playerStatSummaries"},c)},j.prototype.getRankedStats=function(a,b,c){return"function"==typeof b&&null==c&&(c=b,b=null),null!=b&&(b="SEASON"+b),this.request({method:"stats/by-summoner/"+a+"/ranked",version:"1.2",params:{season:b},extract:"champions"},c)},j.prototype.getSummonerById=function(a,b){return this.request({method:"summoner/"+a,version:"1.2"},b)},j.prototype.getSummonerByName=function(a,b){return this.request({method:"summoner/by-name/"+a,version:"1.2"},b)},j.prototype.getRunes=function(a,b){return this.request({method:"summoner/"+a+"/runes",version:"1.2",extract:"pages"},b)},j.prototype.getMasteries=function(a,b){return this.request({method:"summoner/"+a+"/masteries",version:"1.2",extract:"pages"},b)},j.prototype.getNames=function(){var d,e=a(arguments);e.length>0&&"function"==typeof e[e.length-1]&&(d=e.pop());for(var f,g=40,h=[];e.length;)f=e.splice(0,g).join(","),h.push(this.request({method:"summoner/"+f+"/name",version:"1.2",extract:"summoners"}));var i=c(h).then(function(a){return a.reduce(function(a,b){return a.concat(b)},[])});return d&&b(i,d),i},j.prototype.getTeams=function(a,b){return this.request({method:"team/by-summoner/"+a,version:"2.2"},b)},"object"==typeof module&&null!=module.exports?module.exports=j:"undefined"!=typeof window&&(window.Legends=j)}();